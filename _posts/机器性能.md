资源参数以及其性能计数器： 

CPU资源：
　　

类别

计数器名称

计数器描述

CPU

load average

系统平均负载

%us

用户进程占用CPU时间的百分比

%sy

系统进程占用CPU时间的百分比，

%ni

改变过优先级的进程占用CPU时间的百分比

%id

空闲CPU时间的百分比

%wa

IO等待占用CPU时间的百分比

%hi

硬中断占用CPU时间的百分比

%si

软中断占用CPU时间的百分比

%st

其他虚拟CPU占用CPU时间的百分比

核心命令：top



load average：

 load：正在运行和准备好等待运行的进程的总数
 load average：系统平均负载。在特定时间间隔内，在CPU上运行进程队列中运行或者等待运行的进程的平均数量
 系统在过去1分钟、5分钟、15分钟内运行进程队列中的平均进程数
 avg(正在运行的进程数+准备好等待运行的进程数）
 资源上限：单核 load=1*load 多核 load=n*load
%sy，%us：

%us：%user，用户态使用的CPU时间百分比
%sy：%system，系统态使用的CPU时间百分比
可能存在一些设计或者编码上的缺陷
可能系统此时有很严重的I/O问题
一般表示消耗在硬件服务和软件中断上的时间，较大则意味着系统把相当大的时间消耗在内核代码上


%ni：%nice：

用户进程空间内改变过优先级的进程占用CPU时间的百分比

假设一个CPU周期总共有1k个时间片，有2个等待运行的进程A和B，一开始它们的优先级相同，假设内核给他们各分配100个CPU时间片。但是后来进程B的优先级被提高了，那么此时CPU可能就会再给B分配50个时间片，此时ni就是50/1k=5%



%id：%wa：

越高的wa表示越多的CPU资源在等待I/O。如果%wa很高而%us又偏低的话，大致可以推断 I/O 遇到了瓶颈。

 %id：%idle，空闲CPU时间的百分比
 %wa：%wait，I/O等待占用CPU时间的百分比


%hi：%hard interrupt，硬中断占用CPU时间的百分比

硬中断是由与系统相连的外设(比如网卡、硬盘)自动产生的。主要是用来通知操作系统外设状态的变化。比如当网卡收到数据包的时候，就会发出一个硬中断。



%si：%soft interrupt，软中断占用CPU时间的百分比

软中断是由软件本身发给操作系统内核的中断信号，通常是由硬中断处理程序或进程调度程序对操作系统内核的中断，也就是我们常说的系统调用

内存：
类别

计数器名称

计数器描述

内存

swpd

虚拟内存的使用大小

free

空闲内存的大小

buff

作为缓冲区的内存大小。从磁盘读入的数据可能被保持在缓冲区中，以便下一次快速访问

cache

用作缓存的内存大小，cache的值越大，说明能缓存的数据就越多，如果频繁访问的文件都能被cache住，那么磁盘的读IO bi会非常小

si

每秒从磁盘读入虚拟内存的大小（KB）

so

每秒虚拟内存写入磁盘的大小（KB）

核心命令：vmstat（-S m 以m为单位）,top中也有相关参数



r：runnable，表示在运行队列中等待CPU资源的进程数
b：block，表示阻塞，也就是正在等待I/O的进程数
swpd：虚拟内存已使用的大小
free：空闲的物理内存的大小
buff：Linux系统用来存储目录或者权限等的缓冲区
cache：文件缓存
si：swap in，每秒从磁盘（虚拟内存）读入物理内存的数据量
so：swap out，每秒从物理内存写到磁盘（虚拟内存）的数据量
物理内存：物理内存条上的内存
虚拟内存：采用硬盘空间补充物理内存，将暂时不需要的内存页写到硬盘上，已被腾出的内存页需要再次使用时才从硬盘（虚拟内存）中读回物理内存
如果存在大量的页面交换，系统的性能必然会受到很大影响
bi：block in，每秒从块设备（磁盘）读入到内存的数据量
bo：block out，每秒从内存写入到块设备（磁盘）的数据量
in：interrupt，每秒CPU的中断次数
cs：context switch，每秒上下文切换次数
us：user，用户进程占用CPU时间的百分比，较高需优化或扩容
sy：system，系统进程占用CPU时间的百分比，较高需定位
id：idle，空闲CPU时间的百分比，长期低于10%需优化或扩容
wa：wait，CPU等待I/O时间的百分比，过高说明I/O等待比较严重
st：steal，其他虚拟机占用CPU时间的百分比


网络流量(网卡)：
类别

计数器名称

计数器描述

网络

TIME-WAIT

客户端连接在接收到服务器的结束报文段之后，并没有直接进入CLOSED状态，而是转移到TIME_WAIT状态。在这个状态，客户端连接要等待一段长为2MSL的时间，才能完全关闭。

Recv-Q

网络接收队列（KB）

Send-Q

网络发送队列（KB）

retrans/s

每秒TCP重传数量

核心命令：ss , sar 



TIMEWAIT状态：等待状态，过多的话一般有一些异常

LISTEN状态下：

Send-Q：处于LISTEN状态的端口上的全连接队列accept queue的最大长度
Recv-Q：当前在accept queue中和等待进accept queue的连接数
若Recv-Q > Send-Q：有连接请求进不去队列要overflow掉
非LISTEN状态下：

Recv-Q：网络接收队列
收到的数据已经在本地接收缓冲区中，但是还有多少没有被进程取走
如果长期不为0，可能是遭受了拒绝服务攻击或是进程根本就没有读取缓存中的数据


sar：System Activity Report
-n：根据关键字以不同的角度报告实时的网络流量变化
DEV：以设备为单位提供网络统计报告
ETCP：报告TCP层的错误统计，包括重试、断连、重传、错误、RST包等
retrans/s：每秒TCP重传数量，大量TCP重传可能是因为网络环境恶劣，或者服务器压力过大导致丢包。
 磁盘I/O：
类别

计数器名称

计数器描述

磁盘

rrqm/s

每秒合并读操作的次数。如果两个I/O操作发生在相邻的数据块时，它们可以被合并成一个，以提高效率

wrqm/s

每秒合并写操作的次数

r/s

每秒完成的读 I/O 设备次数

w/s

每秒完成的写 I/O 设备次数

avgqu-sz

队列里的平均I/O请求数量，也就是平均未完成的I/O请求数量

await

平均每次设备I/O操作的耗时 (毫秒)，不仅包括硬盘设备处理I/O的时间，还包括了在kernel队列中等待的时间。

r_await

平均每次设备I/O读操作的耗时(毫秒)

w_await

平均每次设备I/O写操作的耗时 (毫秒)

%util

有I/O（即非空闲）的时间比率

核心命令：iostat



%user：用户态占用CPU时间的百分比
%nice：带NICE值的用户态进程占用CPU时间的百分比
%system：系统态占用CPU时间的百分比
%iowait：CPU等待输入输出完成时间的百分比，过高表示磁盘存在I/O瓶颈
%steal：被其他虚拟CPU占用时间的百分比
%idle：CPU空闲时间的百分比
rrqm/s：每秒进行merge的读操作数
wrqm/s：每秒进行merge的写操作数
r/s：每秒完成的读I/O设备次数
w/s：每秒完成的写I/O设备次数
rsec/s：每秒读扇区数
wsec/s：每秒写扇区数
avgrq-sz：平均每次设备I/O操作的数据大小
avgqu-sz：平均I/O队列长度，较大表示有大量I/O在等待，可结合vmstat查看b和wa
await：平均每次设备I/O操作的等待时间（ms），一般应小于5
r_await：平均每次读设备I/O操作的等待时间（ms）
w_await：平均每次写设备I/O操作的等待时间（ms）
svctm：将被废弃，忽略
%util：一秒中有百分之多少的时间用于 I/O 操作，即被I/O消耗的cpu百分比